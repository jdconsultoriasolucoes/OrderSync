<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Configuração de E-mail · OrderSync</title>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <link rel="stylesheet" href="/static/config_email/config_email.css?v=tab-1" />
 <script>
  window.API_BASE = "https://ordersync-backend-59d2.onrender.com";
  window.CONFIG_EMAIL_BASE = window.API_BASE + "/admin/config_email";
  window.NETDIAG_BASE = window.API_BASE + "/admin/netdiag";

  // Use exatamente as rotas do OpenAPI
  window.CONFIG_EMAIL_ENDPOINTS = {
    mensagem:    window.CONFIG_EMAIL_BASE + "/mensagem",
    smtp:        window.CONFIG_EMAIL_BASE + "/smtp",
    testarEnvio: window.CONFIG_EMAIL_BASE + "/teste_envio"
    // OBS: não existe /smtp/teste no seu back
  };
  </script>
 <script defer src="/static/config_email/config_email.js?v=tab-6"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img src="/static/logo.png" class="logo" alt="ORDERSYNC" />
      <span>ORDERSYNC</span>
    </div>
  </header>

  <main class="container">
    <h1>Configuração de E-mail</h1>

    <nav class="tabs" role="tablist" aria-label="Configuração de e-mail">
      <button class="tab active" data-tab="tab-mensagem" role="tab" aria-selected="true">Mensagem</button>
      <button class="tab" data-tab="tab-smtp" role="tab" aria-selected="false">SMTP</button>
    </nav>

    <!-- Guia: Mensagem -->
    <section id="tab-mensagem" class="tab-panel active" role="tabpanel" aria-labelledby="Mensagem">
      <form id="form-mensagem" class="form">
        <div class="field">
          <label>Destinatário interno <small>(separar por vírgula)</small></label>
          <textarea id="destinatario_interno" rows="3" placeholder="ex.: pedidos@empresa.com, compras@empresa.com"></textarea>
        </div>

        <div class="field">
          <label>Assunto padrão</label>
          <input id="assunto_padrao" type="text" placeholder="Novo pedido {{pedido_id}}" />
        </div>

        <div class="field">
          <label>Corpo do e-mail <small>(HTML permitido)</small></label>
          <textarea id="corpo_html" rows="8" placeholder="<p>Olá {{cliente_nome}}, seu pedido {{pedido_id}} foi recebido...</p>"></textarea>
          <p class="help">Placeholders: <code>{{pedido_id}}</code>, <code>{{cliente_nome}}</code>, <code>{{total_pedido}}</code>, <code>{{link_pdf}}</code></p>
        </div>

        <div class="field checkbox">
          <input id="enviar_para_cliente" type="checkbox" />
          <label for="enviar_para_cliente">Enviar também para o cliente</label>
        </div>

        <div class="actions">
          <button type="button" id="btnSalvarMensagem" class="btn primary">Salvar</button>
          <button type="button" id="btnTestarEnvio" class="btn">Testar envio</button>
        </div>
      </form>
    </section>

    <!-- Guia: SMTP -->
    <section id="tab-smtp" class="tab-panel" role="tabpanel" aria-labelledby="SMTP">
      <form id="form-smtp" class="form">
        <div class="grid-2">
          <div class="field">
            <label>Remetente (From)</label>
            <input id="remetente_email" type="email" placeholder="Pedidos &lt;pedidos@empresa.com&gt; ou pedidos@empresa.com" />
          </div>
          <div class="field">
            <label>Servidor SMTP (host)</label>
            <input id="smtp_host" type="text" placeholder="smtp.seudominio.com" />
          </div>
          <div class="field">
            <label>Porta</label>
            <input id="smtp_port" type="number" min="1" step="1" value="587" />
          </div>
          <div class="field">
            <label>Usuário SMTP</label>
            <input id="smtp_user" type="text" placeholder="pedidos@empresa.com" />
          </div>
          <div class="field">
            <label>Senha SMTP</label>
            <input id="smtp_senha" type="password" />
          </div>
          <div class="field checkbox">
            <input id="usar_tls" type="checkbox" checked />
            <label for="usar_tls">Usar TLS</label>
          </div>
        </div>

        <div class="actions">
          <button type="button" id="btnSalvarSMTP" class="btn primary">Salvar</button>
          <button type="button" id="btnTestarSMTP" class="btn">Testar conexão</button>
        </div>
      </form>
    </section>
  </main>
</body>
</html>